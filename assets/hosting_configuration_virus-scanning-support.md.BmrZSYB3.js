import{_ as n,c as a,o as e,j as i,ag as t,a as l}from"./chunks/framework.Bw-5EFTY.js";const v=JSON.parse('{"title":"Virus Scanning (Optional)","description":"","frontmatter":{},"headers":[],"relativePath":"hosting/configuration/virus-scanning-support.md","filePath":"en/hosting/configuration/virus-scanning-support.md","lastUpdated":1754904200000}'),r={name:"hosting/configuration/virus-scanning-support.md"},o={id:"lucide-shield-virus-scanning-optional",tabindex:"-1"},p={class:"lucide lucide-shield",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",width:"1em",height:"1em",style:{"vertical-align":"middle"}};function d(h,s,c,u,g,k){return e(),a("div",null,[i("h1",o,[(e(),a("svg",p,s[0]||(s[0]=[i("path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"},null,-1)]))),s[1]||(s[1]=l(" Virus Scanning (Optional) ")),s[2]||(s[2]=i("a",{class:"header-anchor",href:"#lucide-shield-virus-scanning-optional","aria-label":'Permalink to "@lucide:shield Virus Scanning (Optional)"'},"‚Äã",-1))]),s[3]||(s[3]=t(`<p>Notivae supports <strong>optional virus scanning</strong> for uploaded files. This feature is designed to improve security in environments where users can upload arbitrary attachments ‚Äî especially in multi-user or publicly accessible deployments.</p><h2 id="when-to-enable-virus-scanning" tabindex="-1">When to Enable Virus Scanning <a class="header-anchor" href="#when-to-enable-virus-scanning" aria-label="Permalink to &quot;When to Enable Virus Scanning&quot;">‚Äã</a></h2><p>You should <strong>enable virus scanning</strong> if:</p><ul><li>Notivae is hosted on a <strong>public-facing server</strong></li><li>You allow <strong>guest access</strong> via shared links</li><li>You&#39;re running Notivae in an <strong>enterprise or shared multi-user environment</strong></li><li>You want basic protection against <strong>known malware and trojans</strong></li></ul><p>You can likely <strong>skip enabling scanning</strong> if:</p><ul><li>You&#39;re running a <strong>local or private deployment</strong></li><li><strong>All users are trusted</strong>, such as in internal dev/test setups</li></ul><h2 id="environment-variables" tabindex="-1">Environment Variables <a class="header-anchor" href="#environment-variables" aria-label="Permalink to &quot;Environment Variables&quot;">‚Äã</a></h2><p>Virus scanning is <strong>disabled by default</strong>. To enable it, you must set the <code>CLAMAV_SERVER</code> environment variable:</p><div class="language-dotenv vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dotenv</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">CLAMAV_SERVER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">CLAMAV_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">3310</span></span></code></pre></div><p>Once defined, Notivae will attempt to connect to the ClamAV service. If the connection fails while virus scanning is enabled, <strong>file uploads will be rejected</strong> as a safety precaution.</p><h2 id="how-to-set-up-virus-scanning" tabindex="-1">How to Set Up Virus Scanning <a class="header-anchor" href="#how-to-set-up-virus-scanning" aria-label="Permalink to &quot;How to Set Up Virus Scanning&quot;">‚Äã</a></h2><p>To enable virus scanning, add the ClamAV service to your <code>docker-compose.yml</code>:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-_fdaB" id="tab-hhXX1pW" checked><label data-title="docker-compose.yml" for="tab-hhXX1pW">docker-compose.yml</label></div><div class="blocks"><div class="language-yaml vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  clamav</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">clamav/clamav:stable_base</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    restart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">unless-stopped</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">clamav-db:/var/lib/clamav</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # persists virus signature database</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  clamav-db</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span></code></pre></div></div></div><p>Then configure your <code>.env</code> file with the required environment variables:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-hHcPR" id="tab-cKJ7K5U" checked><label data-title=".env" for="tab-cKJ7K5U">.env</label></div><div class="blocks"><div class="language-dotenv vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">dotenv</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">CLAMAV_SERVER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clamav</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">CLAMAV_PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">3310</span></span></code></pre></div></div></div><p>The official ClamAV image automatically updates its virus definitions <strong>once per day</strong>.</p><div class="warning custom-block github-alert"><p class="custom-block-title">WARNING</p><p>During these updates, ClamAV may temporarily use <strong>up to double its normal RAM</strong> due to <em>concurrent reloading</em>. This mechanism allows scans to continue while ClamAV reloads its updated virus signatures, but it means memory usage can spike briefly. Ensure your host system has enough headroom to handle these periodic memory peaks, especially on low-memory environments.</p></div><h3 id="üîç-testing-virus-scanning" tabindex="-1">üîç Testing Virus Scanning <a class="header-anchor" href="#üîç-testing-virus-scanning" aria-label="Permalink to &quot;üîç Testing Virus Scanning&quot;">‚Äã</a></h3><p>To confirm virus scanning is active and functioning, use the <strong>EICAR test file</strong> ‚Äî a harmless file designed to trigger antivirus systems:</p><ul><li>Download or create it using the string provided at: <a href="https://www.eicar.org/download-anti-malware-testfile/" target="_blank" rel="noreferrer">https://www.eicar.org/download-anti-malware-testfile/</a></li><li>Upload the file to Notivae</li></ul><p>If the scanner is correctly integrated, the upload will be rejected with an error like:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Virus detected: Eicar-Test-Signature</span></span></code></pre></div><p>This confirms scanning is working as expected.</p><h2 id="resource-requirements" tabindex="-1">Resource Requirements <a class="header-anchor" href="#resource-requirements" aria-label="Permalink to &quot;Resource Requirements&quot;">‚Äã</a></h2><p>ClamAV requires a <strong>significant amount of RAM</strong> to function properly. According to official documentation:</p><ul><li>Minimum recommended: <strong>3 GB RAM</strong></li><li>Optimal: <strong>4 GB+ RAM</strong>, depending on signature database and traffic</li></ul><p>You should not enable virus scanning on hosts with limited memory or swap space unless you&#39;re confident in available resources.</p><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">‚Äã</a></h2><p>When enabled:</p><ul><li>Any uploaded attachments are scanned using the ClamAV service</li><li>If a threat is detected, the file is immediately deleted and the upload fails with an error</li><li>Clean files proceed as normal</li></ul>`,30))])}const b=n(r,[["render",d]]);export{v as __pageData,b as default};
